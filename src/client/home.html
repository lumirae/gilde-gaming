<!DOCTYPE html>
<html>
  <head>
    <title>Apen Race</title>
    <link rel="stylesheet" type="text/css" href="public\style.css" />
    <link rel="stylesheet" type="text/css" href="src\client\style.css" />
    <link rel="icon" type="image/x-icon" href="public\images\favicon.ico" />
    <style>
      body {
        background-repeat: no-repeat;
        background-size: cover;
        background-image: url("/public/images/pixil-gif-drawing.gif");
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <!-- Pop-up Window -->
    <div id="waitingPopup" class="popup">
      <div class="popup-content">
        <div><span id="timer">05:00</span> / 05:00</div>
        <br />
        <div class="spinner"></div>
        <p>Waiting for players...</p>
        <div><span id="playerCount">0</span> / 10</div>
        <br />
        <button id="disconnectButton">Disconnect</button>
      </div>
    </div>

    <!-- Buttons for game -->
    <div class="buttons">
      <a
        ><button id="playButton" class="button-background">
          <b>Play</b>
        </button></a
      >
      <a href="#"
        ><button class="button-background"><b>Settings</b></button></a
      >
      <a href="#"
        ><button class="button-background"><b>Leaderboard</b></button></a
      >
      <a
        ><button class="logout-button button-background">
          <b>Logout</b>
        </button></a
      >
    </div>

    <!-- Chat -->
    <div class="chat" id="chat">
      <ul id="messages"></ul>
      <form id="form" action="">
        <input
          id="input"
          autocomplete="off"
          maxlength="255"
          placeholder="Type here to chat . . ."
        />
      </form>
      <script src="/socket.io/socket.io.js"></script>
      <script src="/src/client/chat.js"></script>
      <script src="/src/client/waitingRoom.js"></script>

      <script>
        // logout
        document.addEventListener("DOMContentLoaded", () => {
          // Add an event listener for the logout button
          document
            .querySelector(".logout-button")
            .addEventListener("click", () => {
              // Perform AJAX/Fetch request to log out
              let xhr = new XMLHttpRequest();
              xhr.open("POST", "/logout"); // Create a new route for logout if needed
              xhr.setRequestHeader("Content-Type", "application/json");

              xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                  if (xhr.status === 200) {
                    // Redirect the user to the login page after successful logout
                    window.location.href = "/";
                  } else {
                    // Handle logout error (if any)
                    console.error(
                      "Logout error:",
                      xhr.status,
                      xhr.responseText
                    );
                  }
                }
              };

              xhr.send();
            });
        });
      </script>
    </div>
  </body>
</html>
